window.onload=function(){$("<div>").load(scenariofile,null,function(){function e(a,b,c){if(b>=c)engine.ports.preloadImages.send(a),engine.ports.canvasSize.send({width:WIDTH,height:HEIGHT}),engine.ports.jumpRequest.subscribe(jumpEscape),engine.ports.interpretOneStep.subscribe(interpretOneStep),engine.ports.shakeRequest.subscribe(shakeScreen),engine.ports.newScript.send(g),endLoading();else{var d=new Image;d.onerror=function(){alert("failed to load "+a[b].url)};d.onload=function(){e(a,b+1,c)};d.src=
a[b].url}}function c(){var a=[];for(key in assets.bgimages)a.push(assets.bgimages[key]);for(key in assets.fgimages)for(i in assets.fgimages[key])a.push(assets.fgimages[key][i]);e(a,0,a.length)}var h={name:"",imageInfo:[]};$("#gamescreen:first").each(function(a,b){engine=Elm.embed(Elm.Engine,b,{newScript:[],cycledClickAnim:[[],!0],showPicts:[],changePict:h,fadeOut:0,proceedRequest:!1,canvasSize:{width:0,height:0},isModal:!1,preloadImages:[],clearCanvas:{width:WIDTH,height:HEIGHT},loading:!0,face1direct:!1,
shaking:!1})});startLoading();var f=$(this);thisScript=scenariofile;thisSection="#begin";var g=expandMacro(f.text()).replace(/\uff5c([^\u300a]+)\u300a([^\u300b]+)\u300b/g,"<ruby>$1<rp>(</rp><rt>$2</rt><rp>)</rp></ruby>").replace(/\uff56/g,"<span style='color:red'>&hearts;</span>").split("\n");f.empty();$("#hiddenplace");assets.audio?soundManager.setup({url:swfdir,flashVersion:9,debugMode:!1,onready:function(){for(key in assets.audio)soundManager.createSound({url:assets.audio[key].url,volume:assets.audio[key].volume,
autoLoad:!0,id:key});c()}}):c()})};
