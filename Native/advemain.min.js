window.onload=function(){$("#hiddenplace").load(scenariofile,null,function(){function f(a,c,b){if(c>=b)engine.ports.preloadImages.send(a),engine.ports.canvasSize.send({width:WIDTH,height:HEIGHT}),engine.ports.jumpRequest.subscribe(jumpEscape),engine.ports.interpretOneStep.subscribe(interpretOneStep),engine.ports.shakeRequest.subscribe(shakeScreen),engine.ports.newScript.send(h),endLoading();else{var d=new Image;d.onerror=function(){alert("failed to load "+a[c].url)};d.onload=function(){e.append($("<div>").css("background-image",
"url("+a[c].url+")"));f(a,c+1,b)};d.src=a[c].url}}function g(){var a=[];for(key in assets.images)a.push(assets.images[key]);f(a,0,a.length)}var k={name:"",imageInfo:{url:"",width:0,height:0}};$("#gamescreen:first").each(function(a,b){engine=Elm.embed(Elm.Engine,b,{newScript:[],clickAnim:[],showPicts:[],changePict:k,fadeOut:0,proceedRequest:!1,canvasSize:{width:0,height:0},isModal:!1,preloadImages:[],clearCanvas:{width:WIDTH,height:HEIGHT},loading:!0,face1direct:!1,shaking:!1})});startLoading();var b=
$(this);thisScript=scenariofile;thisSection="#begin";var h=expandMacro(b.text()).replace(/\uff5c([^\u300a]+)\u300a([^\u300b]+)\u300b/g,"<ruby>$1<rp>(</rp><rt>$2</rt><rp>)</rp></ruby>").replace(/\uff56/g,"<span style='color:red'>&hearts;</span>").split("\n");b.empty();var b=$("body"),e=$("<div>");e.css("visibility","hidden");b.append(e);assets.audio?soundManager.setup({url:swfdir,flashVersion:9,debugMode:!1,onready:function(){for(key in assets.audio)soundManager.createSound({url:assets.audio[key].url,
volume:assets.audio[key].volume,autoLoad:!0,id:key});g()}}):g()})};
